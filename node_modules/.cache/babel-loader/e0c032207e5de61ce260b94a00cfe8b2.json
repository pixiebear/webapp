{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.statusFromToken = exports.resetState = void 0;\n\nconst types_1 = require(\"../types\"); // eslint-disable-next-line import/prefer-default-export\n\n\nconst resetState = state => Object.assign(Object.assign({}, state), {\n  gatewayStatus: types_1.GatewayStatus.UNKNOWN,\n  tokenRequested: false,\n  iframeMinimized: false,\n  firstTokenCheck: true,\n  renderIframe: false,\n  gatewayToken: undefined,\n  powoRequested: undefined,\n  refreshTimeoutId: undefined,\n  powoFinished: false,\n  refreshInProgress: false,\n  tokenIssuanceState: types_1.TokenIssuanceState.NOT_REQUESTED,\n  walletToRefresh: undefined,\n  walletPowoInProgress: false,\n  gatekeeperRecordState: undefined,\n  civicPass: {\n    status: types_1.CivicPassIssuanceStatus.NOT_REQUESTED,\n    iframeMinimized: false,\n    renderIframe: false\n  }\n});\n\nexports.resetState = resetState;\n\nconst hasExpired = gatewayToken => {\n  const now = Math.floor(Date.now() / 1000);\n  return !!gatewayToken.expiryTime && now >= gatewayToken.expiryTime;\n};\n\nconst isLocationNotSupported = recordState => {\n  if (!recordState) return false;\n  return [types_1.GatekeeperRecordState.LOCATION_NOT_SUPPORTED].includes(recordState);\n};\n\nconst isIssuedLocationNotSupported = recordState => {\n  if (!recordState) return false;\n  return [types_1.GatekeeperRecordState.ISSUED_LOCATION_NOT_SUPPORTED].includes(recordState);\n};\n\nconst isIssuedVpnNotSupported = recordState => {\n  if (!recordState) return false;\n  return [types_1.GatekeeperRecordState.ISSUED_VPN_NOT_SUPPORTED].includes(recordState);\n};\n\nconst isVpnNotSupported = recordState => {\n  if (!recordState) return false;\n  return [types_1.GatekeeperRecordState.VPN_NOT_SUPPORTED].includes(recordState);\n};\n\nconst statusFromToken = (state, gatewayToken) => {\n  if (!gatewayToken) return state.gatewayStatus;\n\n  switch (gatewayToken.state) {\n    case types_1.State.ACTIVE:\n      if (isLocationNotSupported(state.gatekeeperRecordState)) {\n        return types_1.GatewayStatus.LOCATION_NOT_SUPPORTED;\n      }\n\n      if (isVpnNotSupported(state.gatekeeperRecordState) || isIssuedVpnNotSupported(state.gatekeeperRecordState)) {\n        return types_1.GatewayStatus.VPN_NOT_SUPPORTED;\n      }\n\n      if (isIssuedLocationNotSupported(state.gatekeeperRecordState)) {\n        return types_1.GatewayStatus.REFRESH_TOKEN_REQUIRED;\n      }\n\n      if (state.gatewayStatus === types_1.GatewayStatus.PROOF_OF_WALLET_OWNERSHIP) {\n        return types_1.GatewayStatus.PROOF_OF_WALLET_OWNERSHIP;\n      }\n\n      return hasExpired(gatewayToken) ? types_1.GatewayStatus.REFRESH_TOKEN_REQUIRED : types_1.GatewayStatus.ACTIVE;\n\n    case types_1.State.REVOKED:\n      return types_1.GatewayStatus.REVOKED;\n\n    case types_1.State.FROZEN:\n      return types_1.GatewayStatus.FROZEN;\n\n    default:\n      return types_1.GatewayStatus.UNKNOWN;\n  }\n};\n\nexports.statusFromToken = statusFromToken;","map":{"version":3,"names":["Object","defineProperty","exports","value","statusFromToken","resetState","types_1","require","state","assign","gatewayStatus","GatewayStatus","UNKNOWN","tokenRequested","iframeMinimized","firstTokenCheck","renderIframe","gatewayToken","undefined","powoRequested","refreshTimeoutId","powoFinished","refreshInProgress","tokenIssuanceState","TokenIssuanceState","NOT_REQUESTED","walletToRefresh","walletPowoInProgress","gatekeeperRecordState","civicPass","status","CivicPassIssuanceStatus","hasExpired","now","Math","floor","Date","expiryTime","isLocationNotSupported","recordState","GatekeeperRecordState","LOCATION_NOT_SUPPORTED","includes","isIssuedLocationNotSupported","ISSUED_LOCATION_NOT_SUPPORTED","isIssuedVpnNotSupported","ISSUED_VPN_NOT_SUPPORTED","isVpnNotSupported","VPN_NOT_SUPPORTED","State","ACTIVE","REFRESH_TOKEN_REQUIRED","PROOF_OF_WALLET_OWNERSHIP","REVOKED","FROZEN"],"sources":["/Users/nikola/Sites/candy-machine/candy-machine-ui/node_modules/@civic/solana-gateway-react/dist/esm/useReducer/utils.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.statusFromToken = exports.resetState = void 0;\nconst types_1 = require(\"../types\");\n// eslint-disable-next-line import/prefer-default-export\nconst resetState = (state) => (Object.assign(Object.assign({}, state), { gatewayStatus: types_1.GatewayStatus.UNKNOWN, tokenRequested: false, iframeMinimized: false, firstTokenCheck: true, renderIframe: false, gatewayToken: undefined, powoRequested: undefined, refreshTimeoutId: undefined, powoFinished: false, refreshInProgress: false, tokenIssuanceState: types_1.TokenIssuanceState.NOT_REQUESTED, walletToRefresh: undefined, walletPowoInProgress: false, gatekeeperRecordState: undefined, civicPass: {\n        status: types_1.CivicPassIssuanceStatus.NOT_REQUESTED,\n        iframeMinimized: false,\n        renderIframe: false,\n    } }));\nexports.resetState = resetState;\nconst hasExpired = (gatewayToken) => {\n    const now = Math.floor(Date.now() / 1000);\n    return !!gatewayToken.expiryTime && now >= gatewayToken.expiryTime;\n};\nconst isLocationNotSupported = (recordState) => {\n    if (!recordState)\n        return false;\n    return [types_1.GatekeeperRecordState.LOCATION_NOT_SUPPORTED].includes(recordState);\n};\nconst isIssuedLocationNotSupported = (recordState) => {\n    if (!recordState)\n        return false;\n    return [types_1.GatekeeperRecordState.ISSUED_LOCATION_NOT_SUPPORTED].includes(recordState);\n};\nconst isIssuedVpnNotSupported = (recordState) => {\n    if (!recordState)\n        return false;\n    return [types_1.GatekeeperRecordState.ISSUED_VPN_NOT_SUPPORTED].includes(recordState);\n};\nconst isVpnNotSupported = (recordState) => {\n    if (!recordState)\n        return false;\n    return [types_1.GatekeeperRecordState.VPN_NOT_SUPPORTED].includes(recordState);\n};\nconst statusFromToken = (state, gatewayToken) => {\n    if (!gatewayToken)\n        return state.gatewayStatus;\n    switch (gatewayToken.state) {\n        case types_1.State.ACTIVE:\n            if (isLocationNotSupported(state.gatekeeperRecordState)) {\n                return types_1.GatewayStatus.LOCATION_NOT_SUPPORTED;\n            }\n            if (isVpnNotSupported(state.gatekeeperRecordState) || isIssuedVpnNotSupported(state.gatekeeperRecordState)) {\n                return types_1.GatewayStatus.VPN_NOT_SUPPORTED;\n            }\n            if (isIssuedLocationNotSupported(state.gatekeeperRecordState)) {\n                return types_1.GatewayStatus.REFRESH_TOKEN_REQUIRED;\n            }\n            if (state.gatewayStatus === types_1.GatewayStatus.PROOF_OF_WALLET_OWNERSHIP) {\n                return types_1.GatewayStatus.PROOF_OF_WALLET_OWNERSHIP;\n            }\n            return hasExpired(gatewayToken) ? types_1.GatewayStatus.REFRESH_TOKEN_REQUIRED : types_1.GatewayStatus.ACTIVE;\n        case types_1.State.REVOKED:\n            return types_1.GatewayStatus.REVOKED;\n        case types_1.State.FROZEN:\n            return types_1.GatewayStatus.FROZEN;\n        default:\n            return types_1.GatewayStatus.UNKNOWN;\n    }\n};\nexports.statusFromToken = statusFromToken;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}